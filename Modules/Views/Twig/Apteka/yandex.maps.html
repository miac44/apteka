<div id="YMapsID" style="height: 350px;"></div>

<script type="text/javascript">
    var pharmacyMap;
    function init() {
        pharmacyMap = new ymaps.Map("YMapsID", {
            center: [57.7678, 40.9268],
            zoom: 10
        });
        pharmacyMap.controls.add('mapTools');
        pharmacyMap.controls.add('zoomControl');
        pharmacyMap.controls.add('typeSelector');

	var pharmacyGeoObjects = new ymaps.GeoObjectCollection(null, {
		{# preset: "twirl#redStretchyIcon" #}
preset: 'twirl#hospitalIcon'		
		{#preset: 'islands#redMedicalIcon'#}
	});

	{% if pharmacies is defined %}
		{% if pharmacies is iterable %}
			{% for pharmacy in pharmacies %}
			        var pharmacyGeocoder{{ pharmacy.APTKOD }} = ymaps.geocode("Костромская область, {{ pharmacy.ADRESS }}", {results:1});
				pharmacyGeocoder{{ pharmacy.APTKOD }}.then(
				    function (res) {
					pharmacyGeoObjects.add(res.geoObjects);
					pharmacyMap.setBounds(pharmacyGeoObjects.getBounds());
				    },
				    function (err) {
				    }
				);
			{% endfor %}
		{% endif %}
	{% elseif pharmacy is defined %}
	        var pharmacyGeocoder{{ pharmacy.APTKOD }} = ymaps.geocode("Костромская область, {{ pharmacy.ADRESS }}", {results:1});
		pharmacyGeocoder{{ pharmacy.APTKOD }}.then(
		    function (res) {
			pharmacyGeoObjects.add(res.geoObjects);
			pharmacyMap.setBounds(pharmacyGeoObjects.getBounds(),{checkZoomRange:true, zoomMargin:100});
		    },
		    function (err) {
		    }
		);
	{% endif %}
   pharmacyMap.geoObjects.add(pharmacyGeoObjects);
}
</script>

<script src="https://api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-RU&onload=init" type="text/javascript"> </script>
